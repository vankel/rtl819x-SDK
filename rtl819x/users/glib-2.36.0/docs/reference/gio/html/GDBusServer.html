<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>GDBusServer</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.77.1">
<link rel="home" href="index.html" title="GIO Reference Manual">
<link rel="up" href="gdbus-lowlevel.html" title="Lowlevel D-Bus Support">
<link rel="prev" href="GDBusMethodInvocation.html" title="GDBusMethodInvocation">
<link rel="next" href="GDBusAuthObserver.html" title="GDBusAuthObserver">
<meta name="generator" content="GTK-Doc V1.18.1 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2">
<tr valign="middle">
<td><a accesskey="p" href="GDBusMethodInvocation.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></a></td>
<td><a accesskey="u" href="gdbus-lowlevel.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></a></td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></a></td>
<th width="100%" align="center">GIO Reference Manual</th>
<td><a accesskey="n" href="GDBusAuthObserver.html"><img src="right.png" width="24" height="24" border="0" alt="Next"></a></td>
</tr>
<tr><td colspan="5" class="shortcuts">
<a href="#GDBusServer.synopsis" class="shortcut">Top</a>
                   | 
                  <a href="#GDBusServer.description" class="shortcut">Description</a>
                   | 
                  <a href="#GDBusServer.object-hierarchy" class="shortcut">Object Hierarchy</a>
                   | 
                  <a href="#GDBusServer.implemented-interfaces" class="shortcut">Implemented Interfaces</a>
                   | 
                  <a href="#GDBusServer.properties" class="shortcut">Properties</a>
                   | 
                  <a href="#GDBusServer.signals" class="shortcut">Signals</a>
</td></tr>
</table>
<div class="refentry">
<a name="GDBusServer"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle"><a name="GDBusServer.top_of_page"></a>GDBusServer</span></h2>
<p>GDBusServer — Helper for accepting connections</p>
</td>
<td valign="top" align="right"></td>
</tr></table></div>
<div class="refsynopsisdiv">
<a name="GDBusServer.synopsis"></a><h2>Synopsis</h2>
<a name="GDBusServerFlags"></a><pre class="synopsis">
#include &lt;gio/gio.h&gt;

                    <a class="link" href="GDBusServer.html#GDBusServer-struct" title="GDBusServer">GDBusServer</a>;
enum                <a class="link" href="GDBusServer.html#GDBusServerFlags-enum" title="enum GDBusServerFlags">GDBusServerFlags</a>;
<a class="link" href="GDBusServer.html" title="GDBusServer"><span class="returnvalue">GDBusServer</span></a> *       <a class="link" href="GDBusServer.html#g-dbus-server-new-sync" title="g_dbus_server_new_sync ()">g_dbus_server_new_sync</a>              (<em class="parameter"><code>const <a href="../glib/glib-Basic-Types.html#gchar"><span class="type">gchar</span></a> *address</code></em>,
                                                         <em class="parameter"><code><a class="link" href="GDBusServer.html#GDBusServerFlags"><span class="type">GDBusServerFlags</span></a> flags</code></em>,
                                                         <em class="parameter"><code>const <a href="../glib/glib-Basic-Types.html#gchar"><span class="type">gchar</span></a> *guid</code></em>,
                                                         <em class="parameter"><code><a class="link" href="GDBusAuthObserver.html" title="GDBusAuthObserver"><span class="type">GDBusAuthObserver</span></a> *observer</code></em>,
                                                         <em class="parameter"><code><a class="link" href="GCancellable.html" title="GCancellable"><span class="type">GCancellable</span></a> *cancellable</code></em>,
                                                         <em class="parameter"><code><a href="../glib/glib-Error-Reporting.html#GError"><span class="type">GError</span></a> **error</code></em>);
<span class="returnvalue">void</span>                <a class="link" href="GDBusServer.html#g-dbus-server-start" title="g_dbus_server_start ()">g_dbus_server_start</a>                 (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);
<span class="returnvalue">void</span>                <a class="link" href="GDBusServer.html#g-dbus-server-stop" title="g_dbus_server_stop ()">g_dbus_server_stop</a>                  (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);
<a href="../glib/glib-Basic-Types.html#gboolean"><span class="returnvalue">gboolean</span></a>            <a class="link" href="GDBusServer.html#g-dbus-server-is-active" title="g_dbus_server_is_active ()">g_dbus_server_is_active</a>             (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);
const <a href="../glib/glib-Basic-Types.html#gchar"><span class="returnvalue">gchar</span></a> *       <a class="link" href="GDBusServer.html#g-dbus-server-get-guid" title="g_dbus_server_get_guid ()">g_dbus_server_get_guid</a>              (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);
<a class="link" href="GDBusServer.html#GDBusServerFlags"><span class="returnvalue">GDBusServerFlags</span></a>    <a class="link" href="GDBusServer.html#g-dbus-server-get-flags" title="g_dbus_server_get_flags ()">g_dbus_server_get_flags</a>             (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);
const <a href="../glib/glib-Basic-Types.html#gchar"><span class="returnvalue">gchar</span></a> *       <a class="link" href="GDBusServer.html#g-dbus-server-get-client-address" title="g_dbus_server_get_client_address ()">g_dbus_server_get_client_address</a>    (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);
</pre>
</div>
<div class="refsect1">
<a name="GDBusServer.object-hierarchy"></a><h2>Object Hierarchy</h2>
<pre class="synopsis">
  <a href="../gobject/gobject-The-Base-Object-Type.html#GObject">GObject</a>
   +----GDBusServer
</pre>
<pre class="synopsis">
  GFlags
   +----GDBusServerFlags
</pre>
</div>
<div class="refsect1">
<a name="GDBusServer.implemented-interfaces"></a><h2>Implemented Interfaces</h2>
<p>
GDBusServer implements
 <a class="link" href="GInitable.html" title="GInitable">GInitable</a>.</p>
</div>
<div class="refsect1">
<a name="GDBusServer.properties"></a><h2>Properties</h2>
<pre class="synopsis">
  "<a class="link" href="GDBusServer.html#GDBusServer--active" title='The "active" property'>active</a>"                   <a href="../glib/glib-Basic-Types.html#gboolean"><span class="type">gboolean</span></a>              : Read
  "<a class="link" href="GDBusServer.html#GDBusServer--address" title='The "address" property'>address</a>"                  <a href="../glib/glib-Basic-Types.html#gchar"><span class="type">gchar</span></a>*                : Read / Write / Construct Only
  "<a class="link" href="GDBusServer.html#GDBusServer--authentication-observer" title='The "authentication-observer" property'>authentication-observer</a>"  <a class="link" href="GDBusAuthObserver.html" title="GDBusAuthObserver"><span class="type">GDBusAuthObserver</span></a>*    : Read / Write / Construct Only
  "<a class="link" href="GDBusServer.html#GDBusServer--client-address" title='The "client-address" property'>client-address</a>"           <a href="../glib/glib-Basic-Types.html#gchar"><span class="type">gchar</span></a>*                : Read
  "<a class="link" href="GDBusServer.html#GDBusServer--flags" title='The "flags" property'>flags</a>"                    <a class="link" href="GDBusServer.html#GDBusServerFlags"><span class="type">GDBusServerFlags</span></a>      : Read / Write / Construct Only
  "<a class="link" href="GDBusServer.html#GDBusServer--guid" title='The "guid" property'>guid</a>"                     <a href="../glib/glib-Basic-Types.html#gchar"><span class="type">gchar</span></a>*                : Read / Write / Construct Only
</pre>
</div>
<div class="refsect1">
<a name="GDBusServer.signals"></a><h2>Signals</h2>
<pre class="synopsis">
  "<a class="link" href="GDBusServer.html#GDBusServer-new-connection" title='The "new-connection" signal'>new-connection</a>"                                 : <a href="../gobject/gobject-Signals.html#G-SIGNAL-RUN-LAST:CAPS"><code class="literal">Run Last</code></a>
</pre>
</div>
<div class="refsect1">
<a name="GDBusServer.description"></a><h2>Description</h2>
<p>
<a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> is a helper for listening to and accepting D-Bus
connections. This can be used to create a new D-Bus server, allowing two
peers to use the D-Bus protocol for their own specialized communication.
A server instance provided in this way will not perform message routing or
implement the org.freedesktop.DBus interface.
</p>
<p>
To just export an object on a well-known name on a message bus, such as the
session or system bus, you should instead use <a class="link" href="gio-Owning-Bus-Names.html#g-bus-own-name" title="g_bus_own_name ()"><code class="function">g_bus_own_name()</code></a>.
</p>
<p>
</p>
<div class="example">
<a name="gdbus-peer-to-peer"></a><p class="title"><b>Example 10. D-Bus peer-to-peer example</b></p>
<div class="example-contents">
  <table class="listing_frame" border="0" cellpadding="0" cellspacing="0">
    <tbody>
      <tr>
        <td class="listing_lines" align="right"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306</pre></td>
        <td class="listing_code"><pre class="programlisting"><span class="comment">/*</span>

<span class="comment">Usage examples (modulo addresses / credentials).</span>

<span class="comment">UNIX domain socket transport:</span>

<span class="comment"> Server:</span>
<span class="comment">   $ ./gdbus-example-peer --server --address unix:abstract=myaddr</span>
<span class="comment">   Server is listening at: unix:abstract=myaddr</span>
<span class="comment">   Client connected.</span>
<span class="comment">   Peer credentials: GCredentials:unix-user=500,unix-group=500,unix-process=13378</span>
<span class="comment">   Negotiated capabilities: unix-fd-passing=1</span>
<span class="comment">   Client said: Hey, it's 1273093080 already!</span>

<span class="comment"> Client:</span>
<span class="comment">   $ ./gdbus-example-peer --address unix:abstract=myaddr</span>
<span class="comment">   Connected.</span>
<span class="comment">   Negotiated capabilities: unix-fd-passing=1</span>
<span class="comment">   Server said: You said 'Hey, it's 1273093080 already!'. KTHXBYE!</span>

<span class="comment">Nonce-secured TCP transport on the same host:</span>

<span class="comment"> Server:</span>
<span class="comment">   $ ./gdbus-example-peer --server --address nonce-tcp:</span>
<span class="comment">   Server is listening at: nonce-tcp:host=localhost,port=43077,noncefile=/tmp/gdbus-nonce-file-X1ZNCV</span>
<span class="comment">   Client connected.</span>
<span class="comment">   Peer credentials: (no credentials received)</span>
<span class="comment">   Negotiated capabilities: unix-fd-passing=0</span>
<span class="comment">   Client said: Hey, it's 1273093206 already!</span>

<span class="comment"> Client:</span>
<span class="comment">   $ ./gdbus-example-peer -address nonce-tcp:host=localhost,port=43077,noncefile=/tmp/gdbus-nonce-file-X1ZNCV</span>
<span class="comment">   Connected.</span>
<span class="comment">   Negotiated capabilities: unix-fd-passing=0</span>
<span class="comment">   Server said: You said 'Hey, it's 1273093206 already!'. KTHXBYE!</span>

<span class="comment">TCP transport on two different hosts with a shared home directory:</span>

<span class="comment"> Server:</span>
<span class="comment">   host1 $ ./gdbus-example-peer --server --address tcp:host=0.0.0.0</span>
<span class="comment">   Server is listening at: tcp:host=0.0.0.0,port=46314</span>
<span class="comment">   Client connected.</span>
<span class="comment">   Peer credentials: (no credentials received)</span>
<span class="comment">   Negotiated capabilities: unix-fd-passing=0</span>
<span class="comment">   Client said: Hey, it's 1273093337 already!</span>

<span class="comment"> Client:</span>
<span class="comment">   host2 $ ./gdbus-example-peer -a tcp:host=host1,port=46314</span>
<span class="comment">   Connected.</span>
<span class="comment">   Negotiated capabilities: unix-fd-passing=0</span>
<span class="comment">   Server said: You said 'Hey, it's 1273093337 already!'. KTHXBYE!</span>

<span class="comment">TCP transport on two different hosts without authentication:</span>

<span class="comment"> Server:</span>
<span class="comment">   host1 $ ./gdbus-example-peer --server --address tcp:host=0.0.0.0 --allow-anonymous</span>
<span class="comment">   Server is listening at: tcp:host=0.0.0.0,port=59556</span>
<span class="comment">   Client connected.</span>
<span class="comment">   Peer credentials: (no credentials received)</span>
<span class="comment">   Negotiated capabilities: unix-fd-passing=0</span>
<span class="comment">   Client said: Hey, it's 1273093652 already!</span>

<span class="comment"> Client:</span>
<span class="comment">   host2 $ ./gdbus-example-peer -a tcp:host=host1,port=59556</span>
<span class="comment">   Connected.</span>
<span class="comment">   Negotiated capabilities: unix-fd-passing=0</span>
<span class="comment">   Server said: You said 'Hey, it's 1273093652 already!'. KTHXBYE!</span>

<span class="comment"> </span><span class="comment">*/</span>

<span class="preproc">#include </span><span class="number">&lt;gio/gio.h&gt;</span>
<span class="preproc">#include </span><span class="number">&lt;stdlib.h&gt;</span>

<span class="comment">/*</span><span class="comment"> ---------------------------------------------------------------------------------------------------- </span><span class="comment">*/</span>

<span class="type">static</span> <span class="type">GDBusNodeInfo</span> *introspection_data = <span class="number">NULL</span>;

<span class="comment">/*</span><span class="comment"> Introspection data for the service we are exporting </span><span class="comment">*/</span>
<span class="type">static</span> <span class="type">const</span> <span class="type">gchar</span> introspection_xml[] =
  <span class="number">&quot;&lt;node&gt;&quot;</span>
  <span class="number">&quot;  &lt;interface name='org.gtk.GDBus.TestPeerInterface'&gt;&quot;</span>
  <span class="number">&quot;    &lt;method name='HelloWorld'&gt;&quot;</span>
  <span class="number">&quot;      &lt;arg type='s' name='greeting' direction='in'/&gt;&quot;</span>
  <span class="number">&quot;      &lt;arg type='s' name='response' direction='out'/&gt;&quot;</span>
  <span class="number">&quot;    &lt;/method&gt;&quot;</span>
  <span class="number">&quot;  &lt;/interface&gt;&quot;</span>
  <span class="number">&quot;&lt;/node&gt;&quot;</span>;

<span class="comment">/*</span><span class="comment"> ---------------------------------------------------------------------------------------------------- </span><span class="comment">*/</span>

<span class="type">static</span> <span class="type">void</span>
handle_method_call (<span class="type">GDBusConnection</span>       *connection,
                    <span class="type">const</span> <span class="type">gchar</span>           *sender,
                    <span class="type">const</span> <span class="type">gchar</span>           *object_path,
                    <span class="type">const</span> <span class="type">gchar</span>           *interface_name,
                    <span class="type">const</span> <span class="type">gchar</span>           *method_name,
                    <span class="type">GVariant</span>              *parameters,
                    <span class="type">GDBusMethodInvocation</span> *invocation,
                    <span class="type">gpointer</span>               user_data)
{
  <span class="keyword">if</span> (<span class="function"><a href="../glib/glib-String-Utility-Functions.html#g-strcmp0">g_strcmp0</a></span> (method_name, <span class="number">&quot;HelloWorld&quot;</span>) == <span class="number">0</span>)
    {
      <span class="type">const</span> <span class="type">gchar</span> *greeting;
      <span class="type">gchar</span> *response;

      <span class="function"><a href="../glib/glib-GVariant.html#g-variant-get">g_variant_get</a></span> (parameters, <span class="number">&quot;(&amp;s)&quot;</span>, &amp;greeting);
      response = <span class="function"><a href="../glib/glib-String-Utility-Functions.html#g-strdup-printf">g_strdup_printf</a></span> (<span class="number">&quot;You said '</span><span class="symbol">%s</span><span class="number">'. KTHXBYE!&quot;</span>, greeting);
      <span class="function"><a href="GDBusMethodInvocation.html#g-dbus-method-invocation-return-value">g_dbus_method_invocation_return_value</a></span> (invocation,
                                             <span class="function"><a href="../glib/glib-GVariant.html#g-variant-new">g_variant_new</a></span> (<span class="number">&quot;(s)&quot;</span>, response));
      <span class="function"><a href="../glib/glib-Memory-Allocation.html#g-free">g_free</a></span> (response);
      <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-print">g_print</a></span> (<span class="number">&quot;Client said: </span><span class="symbol">%s</span><span class="symbol">\n</span><span class="number">&quot;</span>, greeting);
    }
}

<span class="type">static</span> <span class="type">const</span> <span class="type">GDBusInterfaceVTable</span> interface_vtable =
{
  handle_method_call,
  <span class="number">NULL</span>,
  <span class="number">NULL</span>,
};

<span class="comment">/*</span><span class="comment"> ---------------------------------------------------------------------------------------------------- </span><span class="comment">*/</span>

<span class="type">static</span> <span class="type">gboolean</span>
on_new_connection (<span class="type">GDBusServer</span> *server,
                   <span class="type">GDBusConnection</span> *connection,
                   <span class="type">gpointer</span> user_data)
{
  <span class="type">guint</span> registration_id;
  <span class="type">GCredentials</span> *credentials;
  <span class="type">gchar</span> *s;

  credentials = <span class="function"><a href="GDBusConnection.html#g-dbus-connection-get-peer-credentials">g_dbus_connection_get_peer_credentials</a></span> (connection);
  <span class="keyword">if</span> (credentials == <span class="number">NULL</span>)
    s = <span class="function"><a href="../glib/glib-String-Utility-Functions.html#g-strdup">g_strdup</a></span> (<span class="number">&quot;(no credentials received)&quot;</span>);
  <span class="keyword">else</span>
    s = <span class="function"><a href="GCredentials.html#g-credentials-to-string">g_credentials_to_string</a></span> (credentials);


  <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-print">g_print</a></span> (<span class="number">&quot;Client connected.</span><span class="symbol">\n</span><span class="number">&quot;</span>
           <span class="number">&quot;Peer credentials: </span><span class="symbol">%s</span><span class="symbol">\n</span><span class="number">&quot;</span>
           <span class="number">&quot;Negotiated capabilities: unix-fd-passing=</span><span class="symbol">%d</span><span class="symbol">\n</span><span class="number">&quot;</span>,
           s,
           <span class="function"><a href="GDBusConnection.html#g-dbus-connection-get-capabilities">g_dbus_connection_get_capabilities</a></span> (connection) &amp; <span class="number">G_DBUS_CAPABILITY_FLAGS_UNIX_FD_PASSING</span>);

  <span class="function"><a href="../gobject/gobject-The-Base-Object-Type.html#g-object-ref">g_object_ref</a></span> (connection);
  registration_id = <span class="function"><a href="GDBusConnection.html#g-dbus-connection-register-object">g_dbus_connection_register_object</a></span> (connection,
                                                       <span class="number">&quot;/org/gtk/GDBus/TestObject&quot;</span>,
                                                       introspection_data-&gt;interfaces[<span class="number">0</span>],
                                                       &amp;interface_vtable,
                                                       <span class="number">NULL</span>,  <span class="comment">/*</span><span class="comment"> user_data </span><span class="comment">*/</span>
                                                       <span class="number">NULL</span>,  <span class="comment">/*</span><span class="comment"> user_data_free_func </span><span class="comment">*/</span>
                                                       <span class="number">NULL</span>); <span class="comment">/*</span><span class="comment"> GError** </span><span class="comment">*/</span>
  <span class="preproc">g_assert</span> (registration_id &gt; <span class="number">0</span>);

  <span class="keyword">return</span> <span class="number">TRUE</span>;
}

<span class="comment">/*</span><span class="comment"> ---------------------------------------------------------------------------------------------------- </span><span class="comment">*/</span>

<span class="type">int</span>
main (<span class="type">int</span> argc, <span class="type">char</span> *argv[])
{
  <span class="type">gint</span> ret;
  <span class="type">gboolean</span> opt_server;
  <span class="type">gchar</span> *opt_address;
  <span class="type">GOptionContext</span> *opt_context;
  <span class="type">gboolean</span> opt_allow_anonymous;
  <span class="type">GError</span> *error;
  <span class="type">GOptionEntry</span> opt_entries[] =
    {
      { <span class="number">&quot;server&quot;</span>, <span class="number">'s'</span>, <span class="number">0</span>, <span class="number">G_OPTION_ARG_NONE</span>, &amp;opt_server, <span class="number">&quot;Start a server instead of a client&quot;</span>, <span class="number">NULL</span> },
      { <span class="number">&quot;address&quot;</span>, <span class="number">'a'</span>, <span class="number">0</span>, <span class="number">G_OPTION_ARG_STRING</span>, &amp;opt_address, <span class="number">&quot;D-Bus address to use&quot;</span>, <span class="number">NULL</span> },
      { <span class="number">&quot;allow-anonymous&quot;</span>, <span class="number">'n'</span>, <span class="number">0</span>, <span class="number">G_OPTION_ARG_NONE</span>, &amp;opt_allow_anonymous, <span class="number">&quot;Allow anonymous authentication&quot;</span>, <span class="number">NULL</span> },
      { <span class="number">NULL</span>}
    };

  ret = <span class="number">1</span>;

  opt_address = <span class="number">NULL</span>;
  opt_server = <span class="number">FALSE</span>;
  opt_allow_anonymous = <span class="number">FALSE</span>;

  opt_context = <span class="function"><a href="../glib/glib-Commandline-option-parser.html#g-option-context-new">g_option_context_new</a></span> (<span class="number">&quot;peer-to-peer example&quot;</span>);
  error = <span class="number">NULL</span>;
  <span class="function"><a href="../glib/glib-Commandline-option-parser.html#g-option-context-add-main-entries">g_option_context_add_main_entries</a></span> (opt_context, opt_entries, <span class="number">NULL</span>);
  <span class="keyword">if</span> (!<span class="function"><a href="../glib/glib-Commandline-option-parser.html#g-option-context-parse">g_option_context_parse</a></span> (opt_context, &amp;argc, &amp;argv, &amp;error))
    {
      <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-printerr">g_printerr</a></span> (<span class="number">&quot;Error parsing options: </span><span class="symbol">%s</span><span class="symbol">\n</span><span class="number">&quot;</span>, error-&gt;message);
      <span class="function"><a href="../glib/glib-Error-Reporting.html#g-error-free">g_error_free</a></span> (error);
      <span class="keyword">goto</span> out;
    }
  <span class="keyword">if</span> (opt_address == <span class="number">NULL</span>)
    {
      <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-printerr">g_printerr</a></span> (<span class="number">&quot;Incorrect usage, try --help.</span><span class="symbol">\n</span><span class="number">&quot;</span>);
      <span class="keyword">goto</span> out;
    }
  <span class="keyword">if</span> (!opt_server &amp;&amp; opt_allow_anonymous)
    {
      <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-printerr">g_printerr</a></span> (<span class="number">&quot;The --allow-anonymous option only makes sense when used with --server.</span><span class="symbol">\n</span><span class="number">&quot;</span>);
      <span class="keyword">goto</span> out;
    }

  <span class="comment">/*</span><span class="comment"> We are lazy here - we don't want to manually provide</span>
<span class="comment">   * the introspection data structures - so we just build</span>
<span class="comment">   * them from XML.</span>
<span class="comment">   </span><span class="comment">*/</span>
  introspection_data = <span class="function"><a href="gio-D-Bus-Introspection-Data.html#g-dbus-node-info-new-for-xml">g_dbus_node_info_new_for_xml</a></span> (introspection_xml, <span class="number">NULL</span>);
  <span class="preproc">g_assert</span> (introspection_data != <span class="number">NULL</span>);

  <span class="keyword">if</span> (opt_server)
    {
      <span class="type">GDBusServer</span> *server;
      <span class="type">gchar</span> *guid;
      <span class="type">GMainLoop</span> *loop;
      <span class="type">GDBusServerFlags</span> server_flags;

      guid = <span class="function"><a href="gio-D-Bus-Utilities.html#g-dbus-generate-guid">g_dbus_generate_guid</a></span> ();

      server_flags = <span class="number">G_DBUS_SERVER_FLAGS_NONE</span>;
      <span class="keyword">if</span> (opt_allow_anonymous)
        server_flags |= <span class="number">G_DBUS_SERVER_FLAGS_AUTHENTICATION_ALLOW_ANONYMOUS</span>;

      error = <span class="number">NULL</span>;
      server = <span class="function"><a href="GDBusServer.html#g-dbus-server-new-sync">g_dbus_server_new_sync</a></span> (opt_address,
                                       server_flags,
                                       guid,
                                       <span class="number">NULL</span>, <span class="comment">/*</span><span class="comment"> GDBusAuthObserver </span><span class="comment">*/</span>
                                       <span class="number">NULL</span>, <span class="comment">/*</span><span class="comment"> GCancellable </span><span class="comment">*/</span>
                                       &amp;error);
      <span class="function"><a href="GDBusServer.html#g-dbus-server-start">g_dbus_server_start</a></span> (server);
      <span class="function"><a href="../glib/glib-Memory-Allocation.html#g-free">g_free</a></span> (guid);

      <span class="keyword">if</span> (server == <span class="number">NULL</span>)
        {
          <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-printerr">g_printerr</a></span> (<span class="number">&quot;Error creating server at address </span><span class="symbol">%s</span><span class="number">: </span><span class="symbol">%s</span><span class="symbol">\n</span><span class="number">&quot;</span>, opt_address, error-&gt;message);
          <span class="function"><a href="../glib/glib-Error-Reporting.html#g-error-free">g_error_free</a></span> (error);
          <span class="keyword">goto</span> out;
        }
      <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-print">g_print</a></span> (<span class="number">&quot;Server is listening at: </span><span class="symbol">%s</span><span class="symbol">\n</span><span class="number">&quot;</span>, <span class="function"><a href="GDBusServer.html#g-dbus-server-get-client-address">g_dbus_server_get_client_address</a></span> (server));
      <span class="preproc">g_signal_connect</span> (server,
                        <span class="number">&quot;new-connection&quot;</span>,
                        <span class="preproc">G_CALLBACK</span> (on_new_connection),
                        <span class="number">NULL</span>);

      loop = <span class="function"><a href="../glib/glib-The-Main-Event-Loop.html#g-main-loop-new">g_main_loop_new</a></span> (<span class="number">NULL</span>, <span class="number">FALSE</span>);
      <span class="function"><a href="../glib/glib-The-Main-Event-Loop.html#g-main-loop-run">g_main_loop_run</a></span> (loop);

      <span class="function"><a href="../gobject/gobject-The-Base-Object-Type.html#g-object-unref">g_object_unref</a></span> (server);
      <span class="function"><a href="../glib/glib-The-Main-Event-Loop.html#g-main-loop-unref">g_main_loop_unref</a></span> (loop);
    }
  <span class="keyword">else</span>
    {
      <span class="type">GDBusConnection</span> *connection;
      <span class="type">const</span> <span class="type">gchar</span> *greeting_response;
      <span class="type">GVariant</span> *value;
      <span class="type">gchar</span> *greeting;

      error = <span class="number">NULL</span>;
      connection = <span class="function"><a href="GDBusConnection.html#g-dbus-connection-new-for-address-sync">g_dbus_connection_new_for_address_sync</a></span> (opt_address,
                                                           <span class="number">G_DBUS_CONNECTION_FLAGS_AUTHENTICATION_CLIENT</span>,
                                                           <span class="number">NULL</span>, <span class="comment">/*</span><span class="comment"> GDBusAuthObserver </span><span class="comment">*/</span>
                                                           <span class="number">NULL</span>, <span class="comment">/*</span><span class="comment"> GCancellable </span><span class="comment">*/</span>
                                                           &amp;error);
      <span class="keyword">if</span> (connection == <span class="number">NULL</span>)
        {
          <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-printerr">g_printerr</a></span> (<span class="number">&quot;Error connecting to D-Bus address </span><span class="symbol">%s</span><span class="number">: </span><span class="symbol">%s</span><span class="symbol">\n</span><span class="number">&quot;</span>, opt_address, error-&gt;message);
          <span class="function"><a href="../glib/glib-Error-Reporting.html#g-error-free">g_error_free</a></span> (error);
          <span class="keyword">goto</span> out;
        }

      <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-print">g_print</a></span> (<span class="number">&quot;Connected.</span><span class="symbol">\n</span><span class="number">&quot;</span>
               <span class="number">&quot;Negotiated capabilities: unix-fd-passing=</span><span class="symbol">%d</span><span class="symbol">\n</span><span class="number">&quot;</span>,
               <span class="function"><a href="GDBusConnection.html#g-dbus-connection-get-capabilities">g_dbus_connection_get_capabilities</a></span> (connection) &amp; <span class="number">G_DBUS_CAPABILITY_FLAGS_UNIX_FD_PASSING</span>);

      greeting = <span class="function"><a href="../glib/glib-String-Utility-Functions.html#g-strdup-printf">g_strdup_printf</a></span> (<span class="number">&quot;Hey, it's %&quot;</span> <span class="number">G_GUINT64_FORMAT</span> <span class="number">&quot; already!&quot;</span>, (<span class="type">guint64</span>) time (<span class="number">NULL</span>));
      value = <span class="function"><a href="GDBusConnection.html#g-dbus-connection-call-sync">g_dbus_connection_call_sync</a></span> (connection,
                                           <span class="number">NULL</span>, <span class="comment">/*</span><span class="comment"> bus_name </span><span class="comment">*/</span>
                                           <span class="number">&quot;/org/gtk/GDBus/TestObject&quot;</span>,
                                           <span class="number">&quot;org.gtk.GDBus.TestPeerInterface&quot;</span>,
                                           <span class="number">&quot;HelloWorld&quot;</span>,
                                           <span class="function"><a href="../glib/glib-GVariant.html#g-variant-new">g_variant_new</a></span> (<span class="number">&quot;(s)&quot;</span>, greeting),
                                           <span class="preproc">G_VARIANT_TYPE</span> (<span class="number">&quot;(s)&quot;</span>),
                                           <span class="number">G_DBUS_CALL_FLAGS_NONE</span>,
                                           -<span class="number">1</span>,
                                           <span class="number">NULL</span>,
                                           &amp;error);
      <span class="keyword">if</span> (value == <span class="number">NULL</span>)
        {
          <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-printerr">g_printerr</a></span> (<span class="number">&quot;Error invoking HelloWorld(): </span><span class="symbol">%s</span><span class="symbol">\n</span><span class="number">&quot;</span>, error-&gt;message);
          <span class="function"><a href="../glib/glib-Error-Reporting.html#g-error-free">g_error_free</a></span> (error);
          <span class="keyword">goto</span> out;
        }
      <span class="function"><a href="../glib/glib-GVariant.html#g-variant-get">g_variant_get</a></span> (value, <span class="number">&quot;(&amp;s)&quot;</span>, &amp;greeting_response);
      <span class="function"><a href="../glib/glib-Warnings-and-Assertions.html#g-print">g_print</a></span> (<span class="number">&quot;Server said: </span><span class="symbol">%s</span><span class="symbol">\n</span><span class="number">&quot;</span>, greeting_response);
      <span class="function"><a href="../glib/glib-GVariant.html#g-variant-unref">g_variant_unref</a></span> (value);

      <span class="function"><a href="../gobject/gobject-The-Base-Object-Type.html#g-object-unref">g_object_unref</a></span> (connection);
    }
  <span class="function"><a href="gio-D-Bus-Introspection-Data.html#g-dbus-node-info-unref">g_dbus_node_info_unref</a></span> (introspection_data);

  ret = <span class="number">0</span>;

 <span class="keyword">out</span>:
  <span class="keyword">return</span> ret;
}</pre></td>
      </tr>
    </tbody>
  </table>
</div>

</div>
<p><br class="example-break">
</p>
</div>
<div class="refsect1">
<a name="GDBusServer.details"></a><h2>Details</h2>
<div class="refsect2">
<a name="GDBusServer-struct"></a><h3>GDBusServer</h3>
<pre class="programlisting">typedef struct _GDBusServer GDBusServer;</pre>
<p>
The <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> structure contains only private data and
should only be accessed using the provided API.
</p>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="GDBusServerFlags-enum"></a><h3>enum GDBusServerFlags</h3>
<pre class="programlisting">typedef enum {
  G_DBUS_SERVER_FLAGS_NONE = 0,
  G_DBUS_SERVER_FLAGS_RUN_IN_THREAD = (1&lt;&lt;0),
  G_DBUS_SERVER_FLAGS_AUTHENTICATION_ALLOW_ANONYMOUS = (1&lt;&lt;1)
} GDBusServerFlags;
</pre>
<p>
Flags used when creating a <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><a name="G-DBUS-SERVER-FLAGS-NONE:CAPS"></a><span class="term"><code class="literal">G_DBUS_SERVER_FLAGS_NONE</code></span></p></td>
<td>No flags set.
</td>
</tr>
<tr>
<td><p><a name="G-DBUS-SERVER-FLAGS-RUN-IN-THREAD:CAPS"></a><span class="term"><code class="literal">G_DBUS_SERVER_FLAGS_RUN_IN_THREAD</code></span></p></td>
<td>All <a class="link" href="GDBusServer.html#GDBusServer-new-connection" title='The "new-connection" signal'><span class="type">"new-connection"</span></a>
signals will run in separated dedicated threads (see signal for
details).
</td>
</tr>
<tr>
<td><p><a name="G-DBUS-SERVER-FLAGS-AUTHENTICATION-ALLOW-ANONYMOUS:CAPS"></a><span class="term"><code class="literal">G_DBUS_SERVER_FLAGS_AUTHENTICATION_ALLOW_ANONYMOUS</code></span></p></td>
<td>Allow the anonymous
authentication method.
</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="g-dbus-server-new-sync"></a><h3>g_dbus_server_new_sync ()</h3>
<pre class="programlisting"><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="returnvalue">GDBusServer</span></a> *       g_dbus_server_new_sync              (<em class="parameter"><code>const <a href="../glib/glib-Basic-Types.html#gchar"><span class="type">gchar</span></a> *address</code></em>,
                                                         <em class="parameter"><code><a class="link" href="GDBusServer.html#GDBusServerFlags"><span class="type">GDBusServerFlags</span></a> flags</code></em>,
                                                         <em class="parameter"><code>const <a href="../glib/glib-Basic-Types.html#gchar"><span class="type">gchar</span></a> *guid</code></em>,
                                                         <em class="parameter"><code><a class="link" href="GDBusAuthObserver.html" title="GDBusAuthObserver"><span class="type">GDBusAuthObserver</span></a> *observer</code></em>,
                                                         <em class="parameter"><code><a class="link" href="GCancellable.html" title="GCancellable"><span class="type">GCancellable</span></a> *cancellable</code></em>,
                                                         <em class="parameter"><code><a href="../glib/glib-Error-Reporting.html#GError"><span class="type">GError</span></a> **error</code></em>);</pre>
<p>
Creates a new D-Bus server that listens on the first address in
<em class="parameter"><code>address</code></em> that works.
</p>
<p>
Once constructed, you can use <a class="link" href="GDBusServer.html#g-dbus-server-get-client-address" title="g_dbus_server_get_client_address ()"><code class="function">g_dbus_server_get_client_address()</code></a> to
get a D-Bus address string that clients can use to connect.
</p>
<p>
Connect to the <a class="link" href="GDBusServer.html#GDBusServer-new-connection" title='The "new-connection" signal'><span class="type">"new-connection"</span></a> signal to handle
incoming connections.
</p>
<p>
The returned <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> isn't active - you have to start it with
<a class="link" href="GDBusServer.html#g-dbus-server-start" title="g_dbus_server_start ()"><code class="function">g_dbus_server_start()</code></a>.
</p>
<p>
See <a class="xref" href="GDBusServer.html#gdbus-peer-to-peer" title="Example 10. D-Bus peer-to-peer example">Example 10, “D-Bus peer-to-peer example”</a> for how <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> can
be used.
</p>
<p>
This is a synchronous failable constructor. See
<code class="function">g_dbus_server_new()</code> for the asynchronous version.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>address</code></em> :</span></p></td>
<td>A D-Bus address.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em> :</span></p></td>
<td>Flags from the <a class="link" href="GDBusServer.html#GDBusServerFlags"><span class="type">GDBusServerFlags</span></a> enumeration.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>guid</code></em> :</span></p></td>
<td>A D-Bus GUID.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>observer</code></em> :</span></p></td>
<td>A <a class="link" href="GDBusAuthObserver.html" title="GDBusAuthObserver"><span class="type">GDBusAuthObserver</span></a> or <a href="../glib/glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>. <span class="annotation">[<acronym title="NULL is ok, both for passing and for returning."><span class="acronym">allow-none</span></acronym>]</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cancellable</code></em> :</span></p></td>
<td>A <a class="link" href="GCancellable.html" title="GCancellable"><span class="type">GCancellable</span></a> or <a href="../glib/glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>. <span class="annotation">[<acronym title="NULL is ok, both for passing and for returning."><span class="acronym">allow-none</span></acronym>]</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>error</code></em> :</span></p></td>
<td>Return location for server or <a href="../glib/glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>.</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>A <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> or <a href="../glib/glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a> if <em class="parameter"><code>error</code></em> is set. Free with
<a href="../gobject/gobject-The-Base-Object-Type.html#g-object-unref"><code class="function">g_object_unref()</code></a>.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="g-dbus-server-start"></a><h3>g_dbus_server_start ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>                g_dbus_server_start                 (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);</pre>
<p>
Starts <em class="parameter"><code>server</code></em>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>A <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a>.</td>
</tr></tbody>
</table></div>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="g-dbus-server-stop"></a><h3>g_dbus_server_stop ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>                g_dbus_server_stop                  (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);</pre>
<p>
Stops <em class="parameter"><code>server</code></em>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>A <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a>.</td>
</tr></tbody>
</table></div>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="g-dbus-server-is-active"></a><h3>g_dbus_server_is_active ()</h3>
<pre class="programlisting"><a href="../glib/glib-Basic-Types.html#gboolean"><span class="returnvalue">gboolean</span></a>            g_dbus_server_is_active             (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);</pre>
<p>
Gets whether <em class="parameter"><code>server</code></em> is active.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>A <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a>.</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>
<a href="../glib/glib-Standard-Macros.html#TRUE:CAPS"><code class="literal">TRUE</code></a> if server is active, <a href="../glib/glib-Standard-Macros.html#FALSE:CAPS"><code class="literal">FALSE</code></a> otherwise.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="g-dbus-server-get-guid"></a><h3>g_dbus_server_get_guid ()</h3>
<pre class="programlisting">const <a href="../glib/glib-Basic-Types.html#gchar"><span class="returnvalue">gchar</span></a> *       g_dbus_server_get_guid              (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);</pre>
<p>
Gets the GUID for <em class="parameter"><code>server</code></em>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>A <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a>.</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>A D-Bus GUID. Do not free this string, it is owned by <em class="parameter"><code>server</code></em>.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="g-dbus-server-get-flags"></a><h3>g_dbus_server_get_flags ()</h3>
<pre class="programlisting"><a class="link" href="GDBusServer.html#GDBusServerFlags"><span class="returnvalue">GDBusServerFlags</span></a>    g_dbus_server_get_flags             (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);</pre>
<p>
Gets the flags for <em class="parameter"><code>server</code></em>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>A <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a>.</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>A set of flags from the <a class="link" href="GDBusServer.html#GDBusServerFlags"><span class="type">GDBusServerFlags</span></a> enumeration.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="g-dbus-server-get-client-address"></a><h3>g_dbus_server_get_client_address ()</h3>
<pre class="programlisting">const <a href="../glib/glib-Basic-Types.html#gchar"><span class="returnvalue">gchar</span></a> *       g_dbus_server_get_client_address    (<em class="parameter"><code><a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> *server</code></em>);</pre>
<p>
Gets a D-Bus address string that can be used by clients to connect
to <em class="parameter"><code>server</code></em>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>A <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a>.</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>A D-Bus address string. Do not free, the string is owned
by <em class="parameter"><code>server</code></em>.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.26</p>
</div>
</div>
<div class="refsect1">
<a name="GDBusServer.property-details"></a><h2>Property Details</h2>
<div class="refsect2">
<a name="GDBusServer--active"></a><h3>The <code class="literal">"active"</code> property</h3>
<pre class="programlisting">  "active"                   <a href="../glib/glib-Basic-Types.html#gboolean"><span class="type">gboolean</span></a>              : Read</pre>
<p>
Whether the server is currently active.
</p>
<p>Default value: FALSE</p>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="GDBusServer--address"></a><h3>The <code class="literal">"address"</code> property</h3>
<pre class="programlisting">  "address"                  <a href="../glib/glib-Basic-Types.html#gchar"><span class="type">gchar</span></a>*                : Read / Write / Construct Only</pre>
<p>
The D-Bus address to listen on.
</p>
<p>Default value: NULL</p>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="GDBusServer--authentication-observer"></a><h3>The <code class="literal">"authentication-observer"</code> property</h3>
<pre class="programlisting">  "authentication-observer"  <a class="link" href="GDBusAuthObserver.html" title="GDBusAuthObserver"><span class="type">GDBusAuthObserver</span></a>*    : Read / Write / Construct Only</pre>
<p>
A <a class="link" href="GDBusAuthObserver.html" title="GDBusAuthObserver"><span class="type">GDBusAuthObserver</span></a> object to assist in the authentication process or <a href="../glib/glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>.
</p>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="GDBusServer--client-address"></a><h3>The <code class="literal">"client-address"</code> property</h3>
<pre class="programlisting">  "client-address"           <a href="../glib/glib-Basic-Types.html#gchar"><span class="type">gchar</span></a>*                : Read</pre>
<p>
The D-Bus address that clients can use.
</p>
<p>Default value: NULL</p>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="GDBusServer--flags"></a><h3>The <code class="literal">"flags"</code> property</h3>
<pre class="programlisting">  "flags"                    <a class="link" href="GDBusServer.html#GDBusServerFlags"><span class="type">GDBusServerFlags</span></a>      : Read / Write / Construct Only</pre>
<p>
Flags from the <a class="link" href="GDBusServer.html#GDBusServerFlags"><span class="type">GDBusServerFlags</span></a> enumeration.
</p>
<p class="since">Since 2.26</p>
</div>
<hr>
<div class="refsect2">
<a name="GDBusServer--guid"></a><h3>The <code class="literal">"guid"</code> property</h3>
<pre class="programlisting">  "guid"                     <a href="../glib/glib-Basic-Types.html#gchar"><span class="type">gchar</span></a>*                : Read / Write / Construct Only</pre>
<p>
The guid of the server.
</p>
<p>Default value: NULL</p>
<p class="since">Since 2.26</p>
</div>
</div>
<div class="refsect1">
<a name="GDBusServer.signal-details"></a><h2>Signal Details</h2>
<div class="refsect2">
<a name="GDBusServer-new-connection"></a><h3>The <code class="literal">"new-connection"</code> signal</h3>
<pre class="programlisting"><a href="../glib/glib-Basic-Types.html#gboolean"><span class="returnvalue">gboolean</span></a>            user_function                      (<a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a>     *server,
                                                        <a class="link" href="GDBusConnection.html" title="GDBusConnection"><span class="type">GDBusConnection</span></a> *connection,
                                                        <a href="../glib/glib-Basic-Types.html#gpointer"><span class="type">gpointer</span></a>         user_data)       : <a href="../gobject/gobject-Signals.html#G-SIGNAL-RUN-LAST:CAPS"><code class="literal">Run Last</code></a></pre>
<p>
Emitted when a new authenticated connection has been made. Use
<a class="link" href="GDBusConnection.html#g-dbus-connection-get-peer-credentials" title="g_dbus_connection_get_peer_credentials ()"><code class="function">g_dbus_connection_get_peer_credentials()</code></a> to figure out what
identity (if any), was authenticated.
</p>
<p>
If you want to accept the connection, take a reference to the
<em class="parameter"><code>connection</code></em> object and return <a href="../glib/glib-Standard-Macros.html#TRUE:CAPS"><code class="literal">TRUE</code></a>. When you are done with the
connection call <a class="link" href="GDBusConnection.html#g-dbus-connection-close" title="g_dbus_connection_close ()"><code class="function">g_dbus_connection_close()</code></a> and give up your
reference. Note that the other peer may disconnect at any time -
a typical thing to do when accepting a connection is to listen to
the <a class="link" href="GDBusConnection.html#GDBusConnection-closed" title='The "closed" signal'><span class="type">"closed"</span></a> signal.
</p>
<p>
If <a class="link" href="GDBusServer.html#GDBusServer--flags" title='The "flags" property'><span class="type">"flags"</span></a> contains <a class="link" href="GDBusServer.html#G-DBUS-SERVER-FLAGS-RUN-IN-THREAD:CAPS"><code class="literal">G_DBUS_SERVER_FLAGS_RUN_IN_THREAD</code></a>
then the signal is emitted in a new thread dedicated to the
connection. Otherwise the signal is emitted in the <GTKDOCLINK HREF="g-main-context-push-thread-default">thread-default main
loop</GTKDOCLINK> of the thread that <em class="parameter"><code>server</code></em> was constructed in.
</p>
<p>
You are guaranteed that signal handlers for this signal runs
before incoming messages on <em class="parameter"><code>connection</code></em> are processed. This means
that it's suitable to call <a class="link" href="GDBusConnection.html#g-dbus-connection-register-object" title="g_dbus_connection_register_object ()"><code class="function">g_dbus_connection_register_object()</code></a> or
similar from the signal handler.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td>The <a class="link" href="GDBusServer.html" title="GDBusServer"><span class="type">GDBusServer</span></a> emitting the signal.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>connection</code></em> :</span></p></td>
<td>A <a class="link" href="GDBusConnection.html" title="GDBusConnection"><span class="type">GDBusConnection</span></a> for the new connection.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>user_data</code></em> :</span></p></td>
<td>user data set when the signal handler was connected.</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td>
<a href="../glib/glib-Standard-Macros.html#TRUE:CAPS"><code class="literal">TRUE</code></a> to claim <em class="parameter"><code>connection</code></em>, <a href="../glib/glib-Standard-Macros.html#FALSE:CAPS"><code class="literal">FALSE</code></a> to let other handlers
run.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.26</p>
</div>
</div>
</div>
<div class="footer">
<hr>
          Generated by GTK-Doc V1.18.1</div>
</body>
</html>