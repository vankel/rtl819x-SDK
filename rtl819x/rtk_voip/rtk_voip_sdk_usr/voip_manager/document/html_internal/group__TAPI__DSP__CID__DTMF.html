<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SIP Interface: Main Page2</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head>
<img src=realtek.jpg>
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">TAPI_DSP - Caller ID for DTMF<div class="ingroups"><a class="el" href="group__TAPI__DSP__GROUP.html">DSP</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The Caller ID for DTMF Interface.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga65673979b0cd279fd848c60508d0f9d5"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TAPI__DSP__CID__DTMF.html#ga65673979b0cd279fd848c60508d0f9d5">rtk_SetDtmfCidString</a> (uint32 chid, const char *str_cid)</td></tr>
<tr class="memdesc:ga65673979b0cd279fd848c60508d0f9d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Caller ID string for DTMF generation.  <a href="#ga65673979b0cd279fd848c60508d0f9d5">More...</a><br/></td></tr>
<tr class="separator:ga65673979b0cd279fd848c60508d0f9d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac7f0c2f318e571a35bb896c0cf607a9c"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TAPI__DSP__CID__DTMF.html#gac7f0c2f318e571a35bb896c0cf607a9c">rtk_GenDtmfCid</a> (uint32 chid, const char *str_cid)</td></tr>
<tr class="memdesc:gac7f0c2f318e571a35bb896c0cf607a9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate DTMF Caller ID.  <a href="#gac7f0c2f318e571a35bb896c0cf607a9c">More...</a><br/></td></tr>
<tr class="separator:gac7f0c2f318e571a35bb896c0cf607a9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga852dec0700b0a22055ccc6d816b690b0"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TAPI__DSP__CID__DTMF.html#ga852dec0700b0a22055ccc6d816b690b0">rtk_SetDtmfCidParam</a> (uint32 chid, <a class="el" href="voip__params_8h.html#a0c013175874f2e4ccfc7d2697d98f94d">DTMF_DIGIT</a> start_digit, <a class="el" href="voip__params_8h.html#a0c013175874f2e4ccfc7d2697d98f94d">DTMF_DIGIT</a> end_digit, uint32 auto_ctrl, uint32 dtmf_on_ms, uint32 dtmf_pause_ms, uint32 dtmf_pre_silence, uint32 dtmf_end_silence)</td></tr>
<tr class="memdesc:ga852dec0700b0a22055ccc6d816b690b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the parameters of DTMF Caller ID Generation.  <a href="#ga852dec0700b0a22055ccc6d816b690b0">More...</a><br/></td></tr>
<tr class="separator:ga852dec0700b0a22055ccc6d816b690b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab8245d14b7a7a684e1aa25e1188c137b"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TAPI__DSP__CID__DTMF.html#gab8245d14b7a7a684e1aa25e1188c137b">rtk_SetDtmfMode</a> (uint32 chid, uint32 mode)</td></tr>
<tr class="memdesc:gab8245d14b7a7a684e1aa25e1188c137b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the DTMF mode.  <a href="#gab8245d14b7a7a684e1aa25e1188c137b">More...</a><br/></td></tr>
<tr class="separator:gab8245d14b7a7a684e1aa25e1188c137b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc253f1c90ba0e5321490446e31fa57c"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TAPI__DSP__CID__DTMF.html#gadc253f1c90ba0e5321490446e31fa57c">rtk_GetDtmfEvent</a> (uint32 chid, uint32 dir, int8 *pEvent, int8 *pEnergy, int16 *pDuration)</td></tr>
<tr class="memdesc:gadc253f1c90ba0e5321490446e31fa57c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve detected DTMF digits, energy, and duration.  <a href="#gadc253f1c90ba0e5321490446e31fa57c">More...</a><br/></td></tr>
<tr class="separator:gadc253f1c90ba0e5321490446e31fa57c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The Caller ID for DTMF Interface. </p>


<h3><a class="anchor" id="VOIP_DSP_CID_DTMF"></a>DTMF</h3><div class="textblock">Dual-tone multi-frequency (DTMF) is a signal used in telecommunication. <br/>
 There are 12 DTMF signals and each of these is made up of two tones. According to the frequency, the tones forming the DTMF signal can be classified into two groups.  <br>
<p  align="left"> <b>Table 4. The DTMF keypad frequencies </b> </p >
<table border=1 width=30% style="border-collapse:collapse;" borderColor=black > 
<td></td> <td align=center>1209 Hz</td> <td align=center>1336 Hz</td> <td align=center>1477 Hz</td><tr> 
<td align=center>697 Hz</td> <td align=center>1</td> <td align=center>2</td> <td align=center>3</td><tr> 
<td align=center>770 Hz</td> <td align=center>4</td> <td align=center>5</td> <td align=center>6</td><tr> 
<td align=center>852 Hz</td> <td align=center>7</td> <td align=center>8</td> <td align=center>9</td><tr> 
<td align=center>941 Hz</td> <td align=center>*</td> <td align=center>0</td> <td align=center>#</td><tr> 
</table>  <br> <p align="center"> <b>DTMF Caller ID Transmission</b>  <div class="image">
<img src="TAPI_DSP_CID_DTMF_Timing.JPG" alt="TAPI_DSP_CID_DTMF_Timing.JPG"/>
</div>
 </div>

<h3><a class="anchor" id="VOIP_DSP_CID_DTMF_STD"></a>DTMF Caller ID Standard</h3><div class="textblock"> <br>
ETSI ETS 300 659-1 (2001) Annex. B <br><br>
<dl>
<dt>1. <b>Line seizure phase </b><br>
<dd>In case of an incoming call to a subscriber, the exchange shall seize the corresponding subscriber line for the
<dd>terminating call. The line seizure may or may not be indicated to the subscriber line by means of a polarity reversal.<br>
<dd>NOTE: Return to idle polarity, if applicable, may take place after the information transfer phase.<br><br>
<dt>2. <b>Alerting phase </b><br>
<dd>When data transmission prior to ringing is used the first ring pattern shall be sent only after completion of the
<dd>transmission of the display information. <br><br>
<dd>When data transmission during ringing is used, the codes shall be sent during the first long silent period between the
<dd>first and the second ring patterns. <br><br>
<dd>Further the normal basic call signalling procedures shall apply. <br><br>
<dt>3. <b>Information transfer phase </b><br>
<dd>Information transfer shall take place in association with ringing. Two methods are possible: <br>
<dd> - data transmission prior to ringing <br>
<dd> - data transmission during ringing <br><br>
<dd>The sending of display information depends on the subscription option between user and network operator. The
<dd>information shall be transmitted by the LE over the seized line to the TE using the DTMF codes, according to
<dd>ES 201 235 [3], as specified below. The LE shall start sending within a predefined time range, not defined here, after
<dd>line seizure. If the call is answered during transmission of the display information, the call shall be regarded, by the LE,
<dd>as being answered and the LE shall then stop any DTMF transmission and through-connect the call.<br><br>
<dd>The start code for calling number shall be either DTMF "A" or "D". <br><br>
<dd>The start code for redirecting number shall be DTMF "D". <br><br>
<dd>The start code for information values shall be DTMF "B". <br><br>
<dd>The information may be sent in any order and shall always end with DTMF "C". <br><br>
<dd>Below are shown some examples of how the transfer of information may look.<br><br>
</dl>
 <br/>
 </p>
<div class="image">
<img src="TAPI_DSP_CID_DTMF_EXAMPLE.JPG" alt="TAPI_DSP_CID_DTMF_EXAMPLE.JPG"/>
</div>
 </div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga65673979b0cd279fd848c60508d0f9d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 rtk_SetDtmfCidString </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>chid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str_cid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set Caller ID string for DTMF generation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chid</td><td>The FXS channel number. </td></tr>
    <tr><td class="paramname">str_cid</td><td>The Caller ID string. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This API is only set caller ID string, so application should enable PCM and check complete. <br/>
 An easy way to achieve this generation, one can use integration API named <a class="el" href="group__TAPI__DSP__CID__DTMF.html#gac7f0c2f318e571a35bb896c0cf607a9c">rtk_GenDtmfCid</a>. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="caller_id_8c-example.html#a8">caller_id.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gac7f0c2f318e571a35bb896c0cf607a9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 rtk_GenDtmfCid </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>chid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str_cid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate DTMF Caller ID. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chid</td><td>The FXS channel number. </td></tr>
    <tr><td class="paramname">str_cid</td><td>The Caller ID string. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>When application calls this API to send DTMF caller ID, DSP ring the phone automatically after sending caller ID. <br/>
 So, there is no need to ring the phone by application. <br/>
 If caller ID is configured to send between 1st and 2nd ring, DSP also can handle it with ring cadence automatically. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="caller_id_8c-example.html#a2">caller_id.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ga852dec0700b0a22055ccc6d816b690b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 rtk_SetDtmfCidParam </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>chid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="voip__params_8h.html#a0c013175874f2e4ccfc7d2697d98f94d">DTMF_DIGIT</a>&#160;</td>
          <td class="paramname"><em>start_digit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="voip__params_8h.html#a0c013175874f2e4ccfc7d2697d98f94d">DTMF_DIGIT</a>&#160;</td>
          <td class="paramname"><em>end_digit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>auto_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>dtmf_on_ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>dtmf_pause_ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>dtmf_pre_silence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>dtmf_end_silence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the parameters of DTMF Caller ID Generation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chid</td><td>The FXS channel number. </td></tr>
    <tr><td class="paramname">start_digit</td><td>DTMF Caller ID start digit </td></tr>
    <tr><td class="paramname">end_digit</td><td>DTMF Caller ID end digit </td></tr>
    <tr><td class="paramname">auto_ctrl</td><td>DSP automatic action <br/>
 Bit 0: Auto start/end digit send <br/>
 Bit 1: Auto SLIC Ring <br/>
 Bit 2: Before 1st Ring<br/>
 Bit 3: Auto SLIC action (SLIC action : such as SLIC hook statue check, line polarity change (not include SLIC Ringing))<br/>
  <font color=#000000> <br> <br>
<table border=1 width=900 style="border-collapse:collapse;" borderColor=black > 
<td align=center><b>value</b></td> <td align=center><b>Bit 0</b></td> <td align=center><b>Bit 1</b></td> <td align=center><b>Bit 2</b></td> <td align=center><b>Bit 3</b></td><tr>  
<td align=center>0</td> <td align=center>Non-Auto mode<br></td> <td align=center>Non-auto mode<br>(DSP send caller ID string only. If caller ID need start/end digits,<br> developer should add them to caller ID strings)</td> <td align=center>After 1st Ring</td> <td align=center>Non-auto mode</td><tr>  
<td align=center>1</td> <td align=center>Auto mode<br></td> <td align=center>Auto mode</td> <td align=center>Before 1st Ring</td> <td align=center>Auto mode</td><tr>  
</table> </font>  </td></tr>
    <tr><td class="paramname">dtmf_on_ms</td><td>DTMF digits on duration (msec, must be multiple of 10msec) </td></tr>
    <tr><td class="paramname">dtmf_pause_ms</td><td>Inter DTMF digits pause duration (msec, must be multiple of 10msec) </td></tr>
    <tr><td class="paramname">dtmf_pre_silence</td><td>The silence duration before DTMF caller ID (msec, must be multiple of 10msec) </td></tr>
    <tr><td class="paramname">dtmf_end_silence</td><td>The silence duration after DTMF caller ID (msec, must be multiple of 10msec) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="caller_id_8c-example.html#a1">caller_id.c</a>, and <a class="el" href="fxo_8c-example.html#a97">fxo.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gab8245d14b7a7a684e1aa25e1188c137b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 rtk_SetDtmfMode </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>chid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the DTMF mode. </p>
<p>For DTMF mode, there are three types of DTMF signaling methods. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chid</td><td>The channel number. </td></tr>
    <tr><td class="paramname">mode</td><td>The DTMF mode.  <font color=#000000> <br> <br>
<table border=1 width=230 style="border-collapse:collapse;" borderColor=black > 
<td align=center><b>DTMF mode</b></td> <td align=center><b>Index</b></td> <tr>
<td align=left>DTMF_RFC2833 </td> <td align=center>0    </td> <tr>
<td align=left>DTMF_SIPINFO </td> <td align=center>1    </td> <tr>
<td align=left>DTMF_INBAND  </td> <td align=center>2    </td> <tr> 
</table> </font>  </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="conference_8c-example.html#a7">conference.c</a>, <a class="el" href="fxo_8c-example.html#a100">fxo.c</a>, <a class="el" href="fxs_8c-example.html#a5">fxs.c</a>, and <a class="el" href="rtp_8c-example.html#a60">rtp.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gadc253f1c90ba0e5321490446e31fa57c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 rtk_GetDtmfEvent </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>chid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8 *&#160;</td>
          <td class="paramname"><em>pEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8 *&#160;</td>
          <td class="paramname"><em>pEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16 *&#160;</td>
          <td class="paramname"><em>pDuration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve detected DTMF digits, energy, and duration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chid</td><td>Channel ID </td></tr>
    <tr><td class="paramname">dir</td><td>0: TDM side, 1: IP side DTMF Event </td></tr>
    <tr><td class="paramname">*pEvent</td><td>A DTMF digit. If digit is 'z', it means FIFO is empty.<br/>
 If digit is 'E', it means END of DTMF digit, and DTMF digit engegy and duration can be got. </td></tr>
    <tr><td class="paramname">*pEnergy</td><td>The detected DTMF digit energy (unit dBFS range:0~-45) </td></tr>
    <tr><td class="paramname">*pDuration</td><td>The detected DTMF digit duration (unit ms) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 3 2014 11:37:44 for VoIP Interface by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
